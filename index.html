<?php
// ====== Handle Upload ======
$message = '';
if(isset($_POST['upload'])){
    $menu = $_POST['menu'];
    $target_dir = "uploads/";
    $filename = basename($_FILES["fileToUpload"]["name"]);
    $target_file = $target_dir . $menu . "_" . $filename;

    if(move_uploaded_file($_FILES["fileToUpload"]["tmp_name"], $target_file)){
        $message = "File berhasil diupload: $filename";
    } else {
        $message = "Gagal upload file.";
    }
}

// ====== Determine Content to Show ======
$content = isset($_GET['menu']) ? $_GET['menu'] : 'dashboard';
?>

<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Dashboard SIAPIS</title>
<style>
body { margin:0; font-family:Arial,sans-serif; background:#F3F4F6; }
.container { display:flex; min-height:100vh; }

/* Sidebar */
.sidebar { width:260px; background:#1E3A8A; color:white; padding:20px; }
.sidebar h2 { text-align:center; margin-bottom:30px; }
.sidebar a, .menu { display:block; padding:12px; margin-bottom:8px; color:white; text-decoration:none; border-radius:6px; cursor:pointer; }
.sidebar a:hover, .menu:hover { background:#2563EB; }
.submenu { display:none; margin-left:15px; }
.submenu a { background:#1E40AF; font-size:14px; }
.submenu.show { display:block; }
.logout { background:#DC2626; text-align:center; }
.logout:hover { background:#B91C1C; }

/* Main */
.main { flex:1; padding:30px; overflow:auto; }
.card { background:white; padding:20px; border-radius:10px; margin-top:20px; box-shadow:0 4px 8px rgba(0,0,0,0.1); }
.card h3 { margin-top:0; }
.btn { padding:6px 12px; margin:3px; border:none; border-radius:5px; cursor:pointer; }
.btn-upload { background:#2563EB; color:white; }
.btn-edit { background:#F59E0B; color:white; }
.btn-delete { background:#DC2626; color:white; }
.btn-export { background:#10B981; color:white; }
textarea { width:100%; }
</style>
</head>
<body>

<div class="container">

  <!-- Sidebar -->
  <aside class="sidebar">
    <h2>SIAPIS</h2>
    <a href="?menu=dashboard">ğŸ  Dashboard</a>

    <div class="menu" onclick="toggleSubmenu('dataMasterSub')">ğŸ“Š Data Master â–¼</div>
    <div class="submenu" id="dataMasterSub">
      <a href="?menu=dataGuru">ğŸ‘©â€ğŸ« Data Guru</a>
      <a href="?menu=dataTendik">ğŸ§‘â€ğŸ’¼ Data Tendik</a>
      <a href="?menu=dataSiswa">ğŸ‘¨â€ğŸ“ Data Siswa</a>
    </div>

    <div class="menu" onclick="toggleSubmenu('sarprasSub')">ğŸ« Sarana & Prasarana â–¼</div>
    <div class="submenu" id="sarprasSub">
      <a href="?menu=barangBergerak">ğŸ“¦ Barang Bergerak</a>
      <a href="?menu=barangTidakBergerak">ğŸ¢ Barang Tidak Bergerak</a>
    </div>

    <div class="menu" onclick="toggleSubmenu('ppdbSub')">ğŸ“ PPDB â–¼</div>
    <div class="submenu" id="ppdbSub">
      <a href="?menu=dataPeserta">ğŸ‘¶ Data Peserta Didik Terdaftar</a>
      <a href="?menu=formulirPPDB">ğŸ“ Formulir Pendaftaran</a>
      <a href="?menu=alurPPDB">â¡ï¸ Alur Pendaftaran</a>
    </div>

    <div class="menu" onclick="toggleSubmenu('adminSub')">âš™ï¸ Admin â–¼</div>
    <div class="submenu" id="adminSub">
      <a href="?menu=suratMasuk">ğŸ“¥ Surat Masuk</a>
      <a href="?menu=suratKeluar">ğŸ“¤ Surat Keluar</a>
      <a href="?menu=suratBerharga">ğŸ’° Surat Berharga</a>
    </div>

    <div class="menu" onclick="toggleSubmenu('profilSub')">ğŸ“š Profil Sekolah â–¼</div>
    <div class="submenu" id="profilSub">
      <a href="?menu=visi">ğŸŒŸ Visi</a>
      <a href="?menu=misi">ğŸ¯ Misi</a>
      <a href="?menu=tujuan">ğŸ“Œ Tujuan</a>
      <a href="?menu=jejakDigital">ğŸ’» Jejak Digital</a>
    </div>

    <a href="#" class="logout">ğŸšª Logout</a>
  </aside>

  <!-- Main Content -->
  <main class="main">
    <div class="card">
      <?php if($message) echo "<p style='color:green;'>$message</p>"; ?>
      
      <?php if($content == 'dashboard'): ?>
        <h1>Dashboard SIAPIS</h1>
        <p>Selamat datang di Sistem Informasi SLBN Alor</p>

      <?php else: ?>
        <h3><?php echo ucwords(str_replace('_',' ',$content)); ?></h3>
        <form action="" method="post" enctype="multipart/form-data">
          <input type="file" name="fileToUpload" required>
          <input type="hidden" name="menu" value="<?php echo $content; ?>">
          <button type="submit" name="upload" class="btn btn-upload">Upload File</button>
        </form>
        <p>File yang diupload akan disimpan di folder <code>uploads/</code></p>
        <p>Contoh download dummy:</p>
        <a href="uploads/<?php echo $content; ?>_example.xlsx" class="btn btn-export">Excel</a>
        <a href="uploads/<?php echo $content; ?>_example.pdf" class="btn btn-export">PDF</a>
      <?php endif; ?>
    </div>
  </main>

</div>

<script>
function toggleSubmenu(id){
  document.getElementById(id).classList.toggle('show');
}
</script>

</body>
</html>
